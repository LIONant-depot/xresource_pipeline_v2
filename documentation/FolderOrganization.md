# *Folder Organization*

We can use subst to simplify a path:

Example:
subst Z: C:\MyFolder

If we did this this can create a safer comman line...

## Project Folder

Examples:

```
Project.lion_library/
├── Descriptors/
├── Assets/
├── Config/
│   ├── Project.config.txt
│   └── Plugins.config.txt
│   
├── Cache/
│   └── Plugins/
│   
└── Scripting/

Project.lion_project/
├── Descriptors/
├── Assets/
│── Config/
│   ├── Project.config.txt
│   ├── TextureCompilerV2.plugin.txt
│   └── Scene.plugin.txt
│   
├── Cache/
│   ├── Descriptors/
│   ├── Resources/
│   │   ├── Windows/
│   │   ├── Android/
│   │   └── Log/
│   │
│   └── Plugins/ ( Engine.plugins, Editor.plugins, Resource.plugins )
│       ├── Texture.plugin/
│       ├── documentaion/
│       ├── dependencies/
│       ├── build/
│       │   ├── updateDependencies.bat
│       │   ├── Compiler.vs2022/
│       │   │   ├── Debug/
│       │   │   └── Release/
│       │   │       └── MeshCompiler.exe
│       │   │
│       │   ├── source/
│       │   ├── Lion.plugin.txt (Installation plugin?)
│       │   ├── TextureCompilerV2.plugin.txt (Runtime configuration?)
│       │   ├── DefaultIcon.dds
│       │   ├── Readme.md
│       │   └── License.md
│       │
│       └── Scene/
│   
└── Scripting/

Art/
Editor/
```

Quick descriptions and key rules for each folder:

| Directory                                                 | Description                                    | Responsibility   | Source Control |
|-----------------------------------------------------------|------------------------------------------------|:--------------:|:--------------:|
| [Descriptors](#Project/Descriptors)                       | Contains one descriptor per resource, organized by GUID to prevent large numbers of files in a single folder. | System | Yes            |
| [Assets](#Project/Assets)                                 | User-generated intermediate files              | User             | Yes            |
| [Config](#Project/Config)                                 | Project configuration files                    | System           | Yes            |
| [Scripts](#Project/Scripts)                               | User-generated scripts                         | User             | Yes            |
| [Cache](#Project/Cache)                                   | Temporary files; safe to delete anytime        | System           | No             |
| [Cache/Temp](#Project/Cache/Temp)                         | Temporary files for immediate deletion         | System           | No             |
| [Cache/Descriptors](#Project/Cache/Descriptors)           | Virtual descriptors from compilers             | System           | No             |
| [Cache/Plugins](#Project/Cache/Plugins)                   | Downloaded and compiled plugins                | System           | No             |
| [Cache/Resources](#Project/Cache/Resources)               | Temporary resources like builds and logs       | System           | No             |
| [Cache/Resources/Build](#Project/Cache/Resources/Build)   | Final build for each platform.                 | System           | No             |
| [Cache/Resources/Logs](#Project/Cache/Resources/Logs)     | Log files for resource compilation.            | System           | No             |
| [Cache/Resources/Platforms](#Project/Cache/Resources/Platforms) | Binary resources for each platform.            | System           | No             |

# [DIR] `Project/Descriptors` <a id="Project/Descriptors"></a>

* Source Controlled
* Files / Folders generated by the System

This is a system/editor control folder and therefore invisible to the user.
This folder is where all the description files will be located.
There will be one descriptor per resource.
Each descriptor will have a folder where all the relevant files will be located.
The name of the folder will be the GUID of the resource in HEX with the extension .desc.

The system will put the descriptor folders under subfolders named after the first two bytes of their GUID.
This is done to make sure that the number of files in a single folder doesn't get too large.

Descriptor Folder Example:

```
Project/
└── Descriptors/ 
    ├── texture/ 
    │   ├── 00/ 
    │   │   ├── fa/ 
    │   │   │   ├── 012fa00.desc
    │   │   │   │   ├── Info.txt
    │   │   │   │   ├── Descriptor.txt
    │   │   │   │   └── Icon.dds
    │   │   │   └── ...
    │   │   └── ...
    │   └── f0/ 
    │       ├── fa/ 
    │       │   ├── e01ffaf0.desc
    │       │   │   ├── Info.txt
    │       │   │   ├── Descriptor.txt
    │       │   │   └── Icon.dds
    │       │   └── ...
    │       └── ...
    ├── mesh/ 
    │   ├── 00/ 
    │   ├── 01/ 
    │   └── ... 
    │   
    └── Scene/ 
        └── f0/ 
            ├── fa/ 
            │   ├── e01ffaf0.desc
            │   │   ├── Info.txt
            │   │   ├── Descriptor.txt
            │   │   ├── Icon.dds
            │   │   └── Entities/...
            │   └── ...
            └── ...
```

* `Info.txt` <a id="Project/Descriptors/Info.txt"></a>
     This file will contain information useful for the asset editor. Which include things like
    the name of the resource, its virtual path, etc.
* `Descriptor.txt` <a id="Project/Descriptors/Descriptor.txt"></a>
    Contains all the relevant information of the actual resource required to compile it.
* `Icon.dds` <a id="Project/Descriptors/Icon.dds"></a>
    Is a custom icon that can be created by the asset editor. This file is optional and is used to
    give a visual representation of the resource. This could be used in the resource browser.
    Since it is custom it must be checked into source control.

## Human readable names for resources

The name of a resource will be a property inside the descriptor file.
This allows the user to change the name without affecting the descriptor file or its dependencies.
(Other resources or components that may have reference to the resource).

## Organizing the resource in a folder (Virtual folder)

The folder name of the resource is a property inside the descriptor file. This allows to 
change the resource organization without affecting the descriptor file location.

## Source Control and Multi-User experience

To make sure that we don't break the history of a descriptor folder in source control, it should never
be renamed or moved. The fact that the descriptor information is broken into two different files 
(Info.txt and Descriptor.txt) will allow users to move the resource virtually or rename it without
touching the actual descriptor. This should minimize the merging that needs to happen. 

# [DIR] `Project/Assets` <a id="Project/Assets"></a>

This folder is fully the responsibility of the user. This is where all the intermediate files go.
The descriptors will point inside these folders to know which assets to compile. 

If files here are moved, some descriptors may break their links. Which will require the user to repair them.
However, if the files are uniquely named, the system could try to find the new location of the files and 
auto heal the links. If there are multiple files named the same, the system could give different choices to the user.

# [DIR] `Project/Config` <a id="Project/Config"></a>

This folder has all the configuration files for the project. 
The project configuration file will have information such as which plugins the project is using and which resource types it understands.
For each of the resource types, there will also be additional configuration files telling the system key information such as where the compilers are.

# [DIR] `Project/Scripts` <a id="Project/Scripts"></a>

This is where all the CPP scripts will go... or should they be in the plugins folder?

# [DIR] `Project/Cache` <a id="Project/Cache"></a>

This is where all the temporary files and folders for the project should be.
All the children folders follow the above rules. 
Any folder could be deleted at any time and the system should be able to recreate it.
The expectation of how long this folder will be alive is usually a long while.

# [DIR] `Project/Cache/Temp` <a id="Project/Cache/Temp"></a>

This folder is the place where the system can put files that are really temporary and can be deleted at any time.
The expectation is that the files inside this folder will be deleted every time the system starts.
It is a great place for things like plugins and other tools to use as temp storage. 
Some effort should be put in the naming of files so that it is clear who created them and that there is no collision.

Example:

* PluginName_GUID.xxx

# [DIR] `Project/Cache/Plugins` <a id="Project/Cache/Plugins"></a>

This folder is where all the plugins will be downloaded from git and compiled. 
Plugins are the way the system can be extended. There are different kinds of plugins:

* **Engine plugins**: They are used to extend the engine functionality. 
    All the engine plugins will be compiled into a single dll together with the engine itself.
* **Resource compiler plugins**: These are plugins that are used to compile resources. 
    This project will generate the compiler for a particular resource type.

A single plugin could have multiple plugins inside of it. 
For example, the texture compiler could have a plugin that generates the compiler as well as modify
the engine to accept and use textures.

# [DIR] `Project/Cache/Descriptors/` <a id="Project/Cache/Descriptors"></a>

This directory is for virtual descriptors, which are generated by resource compilers. 
Note that this folder follows the same exact structure as the [descriptor folder](#Project/Descriptors).

Note that the compiler could dump any data file it wants inside the descriptor folder.
Since these folders don't go into source control it doesn't matter what the compiler puts in there.

# [DIR] `Project/Cache/Resources` <a id="Project/Cache/Resources"></a>

This folder is where all the temporary resources will be placed.

# [DIR] `Project/Cache/Resources/Platforms` <a id="Project/Cache/Resources/Platforms"></a>

This is where the binary resources go for each of the platforms. 
The directory structure is similar to the [descriptor folder](#Project/Descriptors),
However unlike the descriptor folder we will have a platform subfolder to specify 
for which platform the resources are built.

The files in these folders are built anytime a change happens in the:

* Asset folder
* Their Internal Resources Dependencies 
* The compilers that are used to build them
* Their descriptors

Folder Example:
```
Project/Cache/Resources/Platforms/ 
└── Windows/ 
    ├── texture/ 
    │   ├── 00/ 
    │   │   ├── fa/ 
    │   │   │   ├── 012fa00 
    │   │   │   └── ...
    │   │   └── ...
    │   └── 01/ 
    └── mesh/ 
        ├── 00/ 
        ├── 01/ 
        └── ... 
```

The actual resource names will be automatically generated by the resource manager
so the actual resource loader doesn't need to worry about it.

Note that all the resources in these folders may or may not be used in the final game.

# [DIR] `Project/Cache/Resources/Build` <a id="Project/Cache/Resources/Build"></a>

Here is where the final build for each of the platform will be placed.
This will include all the resources that are actually used in the game.
Plus all the relevant exe, config files, etc...

Folder Example:
```
Project/Cache/Resources/Build/ 
├── Windows/ 
│   ├── Game.exe 
│   └── Resources/ 
└── WindowsInstaller.exe
```

# [DIR] `Project/Cache/Resources/Logs` <a id="Project/Cache/Resources/Logs"></a>

When the asset compiler builds the resources it probably wants to output
some additional information such as the log file. Here is where all that information goes.
Note that for every resource compiled a folder will be generated so that we can group 
all the relevant information about a particular resource. It is the job of the
source pipeline to create that folder for the resource compiler. Note that it should
follow the descriptor folder organization as well.

Example:
```
Project/Cache/Resources/Logs/ 
└── texture/ 
    └── 00/ 
        └── fa/ 
            └── 012fa00.log/ 
                ├── Log.txt 
                ├── Icon.dds 
                └── Dependency.txt 
```

* `Log.txt` This is the log file where you can store all the information about the resource compilation.
* `Icon.dds` This could be a generated icons by the resource compiler.
* `Dependency.txt` This file contains all the dependency information for the resource

Note that the compiler could dump any data file it wants in this folder.

# [DIR] `Art`

This folder could be placed nearly anywhere, and this folder is used to place the original/source art files.
These files are such things as: .psd, .3ds, .maya, native to the 3rd party applications. 
The resource pipeline cares very little about these files and they fall fully under the user responsibility.

# [DIR] `Editor`

Editor is the actual real game editor. The editor itself is a shell that mostly creates projects and downloads
plugins which are later used to build the custom_editor.dll which will be used to load the project.
Its job also includes updating new versions of the plugins and such.

----